<div class="container">
    <!-- Header com t√≠tulo e carrinho -->
    <div class="header">
        <div class="header__content">
            <h1 class="header__title">{{ title() }}</h1>
            <p class="header__subtitle">{{ subtitle() }}</p>
        </div>

        <div class="cart-indicator">
            <lucide-icon [img]="icons.ShoppingCart"></lucide-icon>
            <span class="cart-count">{{ totalCartItems() }}</span>
        </div>
    </div>

    <!-- Formul√°rio de busca -->
    <div class="section">
        <div class="search-form">
            <div class="search-input">
                <lucide-icon [img]="icons.Search" class="search-icon"></lucide-icon>
                <input type="text" placeholder="Buscar produtos..." [ngModel]="searchTerm()"
                    (ngModelChange)="onSearchChange($event)" (keyup.enter)="onSearchSubmit()"
                    class="input input--with-icon" />
            </div>
            <button type="button" (click)="onSearchSubmit()" class="btn btn-primary" [disabled]="isLoading()">
                <lucide-icon [img]="icons.Search" [size]="18"></lucide-icon>
                Buscar
            </button>
        </div>
    </div>

    <!-- Estados de loading/erro -->
    @if (isLoading()) {
    <div class="loading-state">
        <div class="spinner"></div>
        <p>Carregando produtos...</p>
    </div>
    }

    @if (error() && !isLoading()) {
    <div class="error-state">
        <p>{{ error() }}</p>
        <button (click)="onRetry()" class="btn btn-secondary">
            Tentar novamente
        </button>
    </div>
    }

    <!-- Lista de produtos -->
    @if (showContent()) {
    <div class="section">
        <!-- Informa√ß√µes da pagina√ß√£o -->
        @if (paginationInfo()) {
        <div class="info-text">
            <p>
                Mostrando {{ paginationInfo()!.start }} - {{ paginationInfo()!.end }}
                de {{ paginationInfo()!.total }} produtos
            </p>
        </div>
        }

        <!-- Grid de produtos -->
        @if (hasProducts()) {
        <div class="grid grid--auto-fit grid--responsive">
            @for (product of products(); track product.id) {
            <div class="product-card card" (click)="onAddToCart(product)" (keyup.enter)="onAddToCart(product)" tabindex="0" role="button">
                <div class="product-card__image">
                    @if (product.image) {
                    <img [src]="product.image" [alt]="product.name" class="product-image" />
                    } @else {
                    <div class="product-image-placeholder">
                        <span>üì¶</span>
                    </div>
                    }
                </div>

                <div class="product-card__content">
                    <h3 class="product-title">{{ product.name }}</h3>
                    <p class="product-description">{{ product.description }}</p>
                </div>

                <div class="product-card__footer">
                    <span class="product-price">{{ formatPrice(product.price) }}</span>
                    <span class="product-view-details">Ver detalhes ‚Üí</span>
                </div>
            </div>
            }
        </div>
        }

        <!-- Estado vazio -->
        @if (isEmpty()) {
        <div class="empty-state">
            <h3>Nenhum produto encontrado</h3>
            <p>Tente ajustar os filtros de busca</p>
        </div>
        }

        <!-- Pagina√ß√£o -->
        @if (showPagination()) {
        <div class="pagination">
            <button (click)="onPageChange(paginationInfo()!.currentPage - 1)"
                [disabled]="!paginationInfo()!.hasPrevious" class="pagination-btn">
                <lucide-icon [img]="icons.ChevronLeft" [size]="10"></lucide-icon>
                Anterior
            </button>

            <div class="pagination-pages">
                @for (page of getPaginationPages(); track page) {
                <button (click)="onPageChange(page)"
                    [class]="page === paginationInfo()!.currentPage ? 'pagination-current' : 'pagination-btn'">
                    {{ page }}
                </button>
                }
            </div>

            <button (click)="onPageChange(paginationInfo()!.currentPage + 1)" [disabled]="!paginationInfo()!.hasNext"
                class="pagination-btn">
                Pr√≥xima
                <lucide-icon [img]="icons.ChevronRight" [size]="10"></lucide-icon>
            </button>
        </div>
        }
    </div>
    }

    <!-- Bot√£o para voltar -->
    <div class="section" style="text-align: center;">
        <a routerLink="/home" class="btn btn-secondary">
            ‚Üê Voltar ao in√≠cio
        </a>
    </div>
</div>